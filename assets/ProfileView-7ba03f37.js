import{_ as k,f as x,y as I,r as y,o as u,g as a,i as e,F as E,m as P,z as m,j as v,w as f,x as w,l as h,v as p,t as d,k as D,q as U,u as N}from"./index-2aa79ce7.js";const g={data(){return{isAdmin:!1,close:x,showDatos:"datos",edit:!0,update:!1,user:[],dataUser:[],dataDirec:[],dataPedido:[],userPedido:[],dniUser:null,nuevoNombre:"",nuevoApellido:"",nuevoDNI:"",nuevoCel:"",verificationDate:"",verificationDirec:"",nuevoProv:"",nuevoLocalidad:"",nuevoCalle:"",nuevoCP:"",nuevoPiso:"",nuevoDpto:"",nuevoDatosE:""}},methods:{closed(){this.edit=!0},editarDatos(){this.edit=!1},updateDatos(){if(this.nuevoNombre==""||this.nuevoApellido==""||this.nuevoDNI==""||this.nuevoCel==""){this.verificationDate="Complete todos los campos por favor.";return}else{this.edit=!0;const n={email:this.userEmail,nombre:this.nuevoNombre,apellido:this.nuevoApellido,dni:this.nuevoDNI,cel:this.nuevoCel},o=`http://127.0.0.1:5000/data/${this.userEmail}`;let i={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)};fetch(o,i).then(r=>{if(r.ok)this.$router.push({name:"profile"}),this.fetchData();else{if(r===400)return r.json();throw new Error("Error en la solicitud")}}).catch(r=>{alert("Error en la solicitud:"+r)})}},editDirec(){this.edit=!1},updateDirec(){if(this.nuevoProv==""||this.nuevoLocalidad==""||this.nuevoCalle==""||this.nuevoCP==""||this.nuevoPiso==""||this.nuevoDpto==""){this.verificationDirec="Complete todos los campos por favor.";return}else{this.nuevoDatosE==""&&(this.nuevoDatosE=null),this.edit=!0;const n={email:this.userEmail,provincia:this.nuevoProv,localidad:this.nuevoLocalidad,calle:this.nuevoCalle,codigo_postal:this.nuevoCP,piso:this.nuevoPiso,dpto:this.nuevoDpto,datos_extra:this.nuevoDatosE},o=`http://127.0.0.1:5000/direc/${this.userEmail}`;let i={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)};fetch(o,i).then(r=>{if(r.ok)this.$router.push({name:"profile"}),this.fetchData();else{if(r===400)return r.json();throw new Error("Error en la solicitud")}}).catch(r=>{alert("Error en la solicitud:"+r)})}},fetchUser(){fetch("http://127.0.0.1:5000/data").then(o=>{if(o.ok)return o.json();throw new Error("Error al obtener los datos")}).then(o=>{this.user=o.filter(i=>i.email===this.userEmail)}).catch(o=>{console.error("Error:",o)})},fetchData(){const n="http://127.0.0.1:5000/data",o="http://127.0.0.1:5000/direc";fetch(n).then(i=>{if(i.ok)return i.json();throw new Error("Error al obtener los datos")}).then(i=>{this.dataUser=i.filter(r=>r.email===this.userEmail),this.dniUser=this.dataUser[0].dni}).catch(i=>{console.error("Error:",i)}),fetch(o).then(i=>{if(i.ok)return i.json();throw new Error("Error al obtener los datos")}).then(i=>{this.dataDirec=i.filter(r=>r.email===this.userEmail)}).catch(i=>{console.error("Error:",i)})},fetchPedidos(){fetch("http://127.0.0.1:5000/pedido").then(n=>{if(n.ok)return n.json();throw new Error("Error al obtener los datos")}).then(n=>{this.dataPedido=n,this.fetchDetallePedido(this.dniUser)}).catch(n=>{console.error("Error:",n)})},getPedidoPorDNI(n){return this.dataPedido.filter(i=>i.dni==n).map(i=>i.numero)},fetchDetallePedido(n){const o=this.getPedidoPorDNI(n);n!==null&&o.forEach(i=>{const r=`http://127.0.0.1:5000/pedido/${i}`;fetch(r).then(s=>{if(s.ok)return s.json();throw new Error("Error al obtener los datos")}).then(s=>{this.userPedido.push(s)}).catch(s=>{console.error("Error:",s)})})},emitLogoutEvent(){this.$store.dispatch("userLoggedOut")},Admin(){this.userEmail=="admin@gmail.com"&&(this.isAdmin=!0)}},computed:{userEmail(){return this.$store.state.userEmail},...I(["userEmail"]),filteredUserData(){return this.dataUser.filter(n=>n.email===this.userEmail)}},mounted(){this.fetchData(),this.fetchUser(),this.fetchPedidos(),this.Admin()}},l=n=>(U("data-v-5693592c"),n=n(),N(),n),A={class:"main-perfil"},V={class:"welcome"},L=l(()=>e("div",null,[e("h1",null,"Bienvenido")],-1)),j={key:0},S={class:"wrapper-list"},z={class:"list"},T=l(()=>e("h3",null,"Datos de tu Cuenta",-1)),B={key:0},O={key:0,class:"list-data"},F={class:"data-perfil"},J=l(()=>e("h4",null,"Nombre",-1)),q=l(()=>e("h4",null,"Apellido",-1)),M=l(()=>e("h4",null,"DNI",-1)),G=l(()=>e("h4",null,"Celular",-1)),H={class:"edit"},K=l(()=>e("label",{for:"nombreInput"},"Nombre:",-1)),Q=l(()=>e("label",{for:"apellidoInput"},"Apellido:",-1)),R=l(()=>e("label",{for:"dniInput"},"DNI:",-1)),W=l(()=>e("label",{for:"celularInput"},"Celular:",-1)),X={class:"verification"},Y={key:1,class:"list-direc"},Z={class:"data-perfil"},$=l(()=>e("h4",null,"Provincia",-1)),ee=l(()=>e("h4",null,"Localidad",-1)),oe=l(()=>e("h4",null,"Calle",-1)),te=l(()=>e("h4",null,"Codigo Postal",-1)),se=l(()=>e("h4",null,"Piso",-1)),le=l(()=>e("h4",null,"Dpto",-1)),ie=l(()=>e("h4",null,"Datos Extra",-1)),ne={class:"edit"},re=l(()=>e("label",{for:"provinciaInput"},"Provincia:",-1)),de=l(()=>e("label",{for:"localidadInput"},"Localidad:",-1)),ue=l(()=>e("label",{for:"calleInput"},"Calle:",-1)),ae=l(()=>e("label",{for:"codPInput"},"Codigo Postal:",-1)),ce=l(()=>e("label",{for:"pisoInput"},"Piso:",-1)),he=l(()=>e("label",{for:"dptoInput"},"Dpto:",-1)),pe=l(()=>e("label",{for:"datosEInput"},"Datos Extra:",-1)),ve={class:"container-message"},me={class:"verification"},_e={key:2,class:"list-pedido"},fe={class:"data-perfil"},De=l(()=>e("h3",null,"Articulos",-1)),Ee=l(()=>e("h3",null,"Importe",-1)),Pe=l(()=>e("h3",null,"Codigo de la compra",-1)),be={class:"help"},Ce=l(()=>e("h3",null,"¿Necesitas Ayuda?",-1)),ye={class:"help-data"};function we(n,o,i,r,s,c){const _=y("router-link"),b=y("ion-icon");return u(),a("main",A,[e("div",V,[L,(u(!0),a(E,null,P(s.user,t=>(u(),a("div",{key:t.email},[t.nombre!=="-"?(u(),a("h1",j,d(t.nombre)+"!",1)):w("",!0)]))),128))]),e("div",S,[e("div",z,[T,e("ul",null,[e("li",{class:m(["elem-list",{on:s.showDatos=="datos"}]),onClick:o[0]||(o[0]=t=>s.showDatos="datos")}," Datos Personales ",2),e("li",{class:m(["elem-list",{on:s.showDatos=="direc"}]),onClick:o[1]||(o[1]=t=>s.showDatos="direc")}," Dirección ",2),e("li",{class:m(["elem-list",{on:s.showDatos=="pedidos"}]),onClick:o[2]||(o[2]=t=>s.showDatos="pedidos")}," Pedidos ",2),s.isAdmin?(u(),a("li",B,[v(_,{to:{name:"admin"}},{default:f(()=>[D("Administrar")]),_:1})])):w("",!0),e("li",{class:"elem-list",onClick:o[3]||(o[3]=(...t)=>c.emitLogoutEvent&&c.emitLogoutEvent(...t))}," Cerrar sesión ")])]),s.showDatos=="datos"?(u(),a("div",O,[e("div",F,[(u(!0),a(E,null,P(s.dataUser,t=>(u(),a("div",{class:m(["datos-personales",{edit:!s.edit}]),key:t.email},[e("div",null,[J,e("span",null,d(t.nombre),1)]),e("div",null,[q,e("span",null,d(t.apellido),1)]),e("div",null,[M,e("span",null,d(t.dni),1)]),e("div",null,[G,e("span",null,d(t.cel),1)]),e("div",H,[e("button",{type:"button",class:"edit-btn",onClick:o[4]||(o[4]=(...C)=>c.editarDatos&&c.editarDatos(...C))},"Editar")])],2))),128)),e("div",{id:"edicion",class:m({update:!s.edit})},[e("span",{class:"close-datos",onClick:o[5]||(o[5]=(...t)=>c.closed&&c.closed(...t))},[v(b,{src:s.close},null,8,["src"])]),e("div",null,[K,h(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=t=>s.nuevoNombre=t)},null,512),[[p,s.nuevoNombre]])]),e("div",null,[Q,h(e("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=t=>s.nuevoApellido=t)},null,512),[[p,s.nuevoApellido]])]),e("div",null,[R,h(e("input",{type:"number","onUpdate:modelValue":o[8]||(o[8]=t=>s.nuevoDNI=t)},null,512),[[p,s.nuevoDNI]])]),e("div",null,[W,h(e("input",{type:"number","onUpdate:modelValue":o[9]||(o[9]=t=>s.nuevoCel=t)},null,512),[[p,s.nuevoCel]])]),e("div",null,[e("button",{class:"actualizar",onClick:o[10]||(o[10]=(...t)=>c.updateDatos&&c.updateDatos(...t))},"Actualizar")]),e("div",null,[e("div",X,d(s.verificationDate),1)])],2)])])):s.showDatos=="direc"?(u(),a("div",Y,[e("div",Z,[(u(!0),a(E,null,P(s.dataDirec,t=>(u(),a("div",{class:m(["data-direc",{edit:!s.edit}]),key:t.email},[e("div",null,[$,e("span",null,d(t.provincia),1)]),e("div",null,[ee,e("span",null,d(t.localidad),1)]),e("div",null,[oe,e("span",null,d(t.calle),1)]),e("div",null,[te,e("span",null,d(t.codigo_postal),1)]),e("div",null,[se,e("span",null,d(t.piso),1)]),e("div",null,[le,e("span",null,d(t.dpto),1)]),e("div",null,[ie,e("span",null,d(t.datos_extra),1)]),e("div",ne,[e("button",{type:"button",class:"edit-btn",onClick:o[11]||(o[11]=C=>c.editDirec())},"Editar")])],2))),128)),e("div",{class:m({update:!s.edit}),id:"edicion-direc"},[e("span",{class:"close-datos",onClick:o[12]||(o[12]=(...t)=>c.closed&&c.closed(...t))},[v(b,{src:s.close},null,8,["src"])]),e("div",null,[re,h(e("input",{type:"text","onUpdate:modelValue":o[13]||(o[13]=t=>s.nuevoProv=t)},null,512),[[p,s.nuevoProv]])]),e("div",null,[de,h(e("input",{type:"text","onUpdate:modelValue":o[14]||(o[14]=t=>s.nuevoLocalidad=t)},null,512),[[p,s.nuevoLocalidad]])]),e("div",null,[ue,h(e("input",{type:"text","onUpdate:modelValue":o[15]||(o[15]=t=>s.nuevoCalle=t)},null,512),[[p,s.nuevoCalle]])]),e("div",null,[ae,h(e("input",{type:"number","onUpdate:modelValue":o[16]||(o[16]=t=>s.nuevoCP=t)},null,512),[[p,s.nuevoCP]])]),e("div",null,[ce,h(e("input",{type:"text","onUpdate:modelValue":o[17]||(o[17]=t=>s.nuevoPiso=t)},null,512),[[p,s.nuevoPiso]])]),e("div",null,[he,h(e("input",{type:"text","onUpdate:modelValue":o[18]||(o[18]=t=>s.nuevoDpto=t)},null,512),[[p,s.nuevoDpto]])]),e("div",null,[pe,h(e("textarea",{cols:"20",rows:"3","onUpdate:modelValue":o[19]||(o[19]=t=>s.nuevoDatosE=t)},null,512),[[p,s.nuevoDatosE]])]),e("div",null,[e("button",{class:"actualizar",onClick:o[20]||(o[20]=(...t)=>c.updateDirec&&c.updateDirec(...t))},"Actualizar")]),e("div",ve,[e("div",me,d(s.verificationDirec),1)])],2)])])):(u(),a("div",_e,[e("div",fe,[(u(!0),a(E,null,P(s.userPedido,t=>(u(),a("div",{class:"data-pedidos",key:t.numero},[e("div",null,[De,e("span",null,"- "+d(t.productos),1)]),e("div",null,[Ee,e("span",null,"$"+d(t.importe),1)]),e("div",null,[Pe,e("span",null,d(t.numero),1)])]))),128))])]))]),e("div",be,[Ce,e("div",ye,[v(_,{to:{name:"buzos"},class:"index"},{default:f(()=>[D("Productos")]),_:1}),v(_,{to:{name:"help"},class:"index"},{default:f(()=>[D("Pedidos y formas de pagos")]),_:1}),v(_,{to:{name:"help"},class:"index"},{default:f(()=>[D("Devoluciones y reembolsos")]),_:1}),v(_,{to:{name:"help"},class:"index"},{default:f(()=>[D("Entrega")]),_:1}),v(_,{to:{name:"about"},class:"index"},{default:f(()=>[D("Sobre nosótros")]),_:1})])])])}const xe=k(g,[["render",we],["__scopeId","data-v-5693592c"]]);export{xe as default};
